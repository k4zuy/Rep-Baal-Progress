Module CUDA/11.7.0GCCcore/11.3.0Python/3.10.4 and 11 dependencies loaded.
Directory /lustre/ssd/ws/keki996e-all_pathmnist_cifar10 does not exist.
Creating new environment for job all_pathmnist_cifar10
Info: creating workspace.
remaining extensions  : 2
remaining time in days: 7
WS_Name: all_pathmnist_cifar10
WS_Path: /lustre/ssd/ws/keki996e-all_pathmnist_cifar10
created virtual environment CPython3.10.4.final.0-64 in 4659ms
  creator CPython3Posix(dest=/lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv, clear=False, no_vcs_ignore=False, global=False)
  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/h3/keki996e/.local/share/virtualenv)
    added seed packages: pip==22.3.1, setuptools==65.6.3, wheel==0.38.4
  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
Collecting torch
  Using cached torch-1.13.1-cp310-cp310-manylinux1_x86_64.whl (887.5 MB)
Collecting torchvision
  Using cached torchvision-0.14.1-cp310-cp310-manylinux1_x86_64.whl (24.2 MB)
Collecting tensorboardX
  Using cached tensorboardX-2.5.1-py2.py3-none-any.whl (125 kB)
Collecting baal
  Using cached baal-1.7.0-py3-none-any.whl (61 kB)
Collecting tqdm
  Using cached tqdm-4.64.1-py2.py3-none-any.whl (78 kB)
Collecting Pillow
  Using cached Pillow-9.4.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.3 MB)
Collecting pandas
  Using cached pandas-1.5.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.1 MB)
Collecting medmnist
  Using cached medmnist-2.1.0-py3-none-any.whl (21 kB)
Collecting nvidia-cudnn-cu11==8.5.0.96
  Using cached nvidia_cudnn_cu11-8.5.0.96-2-py3-none-manylinux1_x86_64.whl (557.1 MB)
Collecting typing-extensions
  Using cached typing_extensions-4.4.0-py3-none-any.whl (26 kB)
Collecting nvidia-cublas-cu11==11.10.3.66
  Using cached nvidia_cublas_cu11-11.10.3.66-py3-none-manylinux1_x86_64.whl (317.1 MB)
Collecting nvidia-cuda-runtime-cu11==11.7.99
  Using cached nvidia_cuda_runtime_cu11-11.7.99-py3-none-manylinux1_x86_64.whl (849 kB)
Collecting nvidia-cuda-nvrtc-cu11==11.7.99
  Using cached nvidia_cuda_nvrtc_cu11-11.7.99-2-py3-none-manylinux1_x86_64.whl (21.0 MB)
Requirement already satisfied: wheel in /lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch) (0.38.4)
Requirement already satisfied: setuptools in /lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch) (65.6.3)
Collecting requests
  Using cached requests-2.28.1-py3-none-any.whl (62 kB)
Collecting numpy
  Using cached numpy-1.24.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.3 MB)
Collecting protobuf<=3.20.1,>=3.8.0
  Using cached protobuf-3.20.1-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.1 MB)
Collecting h5py<4.0.0,>=3.4.0
  Using cached h5py-3.7.0-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (4.5 MB)
Collecting scipy<2.0.0,>=1.7.1
  Downloading scipy-1.10.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (34.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 34.4/34.4 MB 33.0 MB/s eta 0:00:00
Collecting matplotlib<4.0.0,>=3.4.3
  Using cached matplotlib-3.6.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.8 MB)
Collecting torchmetrics<0.10.0,>=0.9.3
  Using cached torchmetrics-0.9.3-py3-none-any.whl (419 kB)
Collecting structlog<22.0.0,>=21.1.0
  Using cached structlog-21.5.0-py3-none-any.whl (53 kB)
Collecting scikit-learn<2.0.0,>=1.0.0
  Using cached scikit_learn-1.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (9.5 MB)
Collecting python-dateutil>=2.8.1
  Using cached python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)
Collecting pytz>=2020.1
  Using cached pytz-2022.7-py2.py3-none-any.whl (499 kB)
Collecting scikit-image
  Downloading scikit_image-0.19.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.9/13.9 MB 57.0 MB/s eta 0:00:00
Collecting fire
  Downloading fire-0.5.0.tar.gz (88 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 88.3/88.3 kB 1.4 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting contourpy>=1.0.1
  Using cached contourpy-1.0.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (296 kB)
Collecting kiwisolver>=1.0.1
  Using cached kiwisolver-1.4.4-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.6 MB)
Collecting fonttools>=4.22.0
  Using cached fonttools-4.38.0-py3-none-any.whl (965 kB)
Collecting pyparsing>=2.2.1
  Using cached pyparsing-3.0.9-py3-none-any.whl (98 kB)
Collecting packaging>=20.0
  Using cached packaging-22.0-py3-none-any.whl (42 kB)
Collecting cycler>=0.10
  Using cached cycler-0.11.0-py3-none-any.whl (6.4 kB)
Collecting six>=1.5
  Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)
Collecting threadpoolctl>=2.0.0
  Using cached threadpoolctl-3.1.0-py3-none-any.whl (14 kB)
Collecting joblib>=1.1.1
  Using cached joblib-1.2.0-py3-none-any.whl (297 kB)
Collecting termcolor
  Downloading termcolor-2.2.0-py3-none-any.whl (6.6 kB)
Collecting idna<4,>=2.5
  Using cached idna-3.4-py3-none-any.whl (61 kB)
Collecting certifi>=2017.4.17
  Using cached certifi-2022.12.7-py3-none-any.whl (155 kB)
Collecting charset-normalizer<3,>=2
  Using cached charset_normalizer-2.1.1-py3-none-any.whl (39 kB)
Collecting urllib3<1.27,>=1.21.1
  Using cached urllib3-1.26.13-py2.py3-none-any.whl (140 kB)
Collecting PyWavelets>=1.1.1
  Downloading PyWavelets-1.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.8/6.8 MB 51.6 MB/s eta 0:00:00
Collecting tifffile>=2019.7.26
  Downloading tifffile-2022.10.10-py3-none-any.whl (210 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 210.3/210.3 kB 4.7 MB/s eta 0:00:00
Collecting imageio>=2.4.1
  Downloading imageio-2.23.0-py3-none-any.whl (3.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.4/3.4 MB 45.3 MB/s eta 0:00:00
Collecting networkx>=2.2
  Downloading networkx-2.8.8-py3-none-any.whl (2.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 23.5 MB/s eta 0:00:00
Building wheels for collected packages: fire
  Building wheel for fire (setup.py): started
  Building wheel for fire (setup.py): finished with status 'done'
  Created wheel for fire: filename=fire-0.5.0-py2.py3-none-any.whl size=116931 sha256=5006497681b8e18581861db9505eeae575b5f9a2595d86eed264f469070ad6c5
  Stored in directory: /home/h3/keki996e/.cache/pip/wheels/c4/eb/6a/1c6d2ad660043768e998bdf9c6a28db2f1b7db3a5825d51e87
Successfully built fire
Installing collected packages: pytz, urllib3, typing-extensions, tqdm, threadpoolctl, termcolor, structlog, six, pyparsing, protobuf, Pillow, packaging, nvidia-cuda-runtime-cu11, nvidia-cuda-nvrtc-cu11, nvidia-cublas-cu11, numpy, networkx, kiwisolver, joblib, idna, fonttools, cycler, charset-normalizer, certifi, tifffile, tensorboardX, scipy, requests, PyWavelets, python-dateutil, nvidia-cudnn-cu11, imageio, h5py, fire, contourpy, torch, scikit-learn, scikit-image, pandas, matplotlib, torchvision, torchmetrics, medmnist, baal
Successfully installed Pillow-9.4.0 PyWavelets-1.4.1 baal-1.7.0 certifi-2022.12.7 charset-normalizer-2.1.1 contourpy-1.0.6 cycler-0.11.0 fire-0.5.0 fonttools-4.38.0 h5py-3.7.0 idna-3.4 imageio-2.23.0 joblib-1.2.0 kiwisolver-1.4.4 matplotlib-3.6.2 medmnist-2.1.0 networkx-2.8.8 numpy-1.24.1 nvidia-cublas-cu11-11.10.3.66 nvidia-cuda-nvrtc-cu11-11.7.99 nvidia-cuda-runtime-cu11-11.7.99 nvidia-cudnn-cu11-8.5.0.96 packaging-22.0 pandas-1.5.2 protobuf-3.20.1 pyparsing-3.0.9 python-dateutil-2.8.2 pytz-2022.7 requests-2.28.1 scikit-image-0.19.3 scikit-learn-1.2.0 scipy-1.10.0 six-1.16.0 structlog-21.5.0 tensorboardX-2.5.1 termcolor-2.2.0 threadpoolctl-3.1.0 tifffile-2022.10.10 torch-1.13.1 torchmetrics-0.9.3 torchvision-0.14.1 tqdm-4.64.1 typing-extensions-4.4.0 urllib3-1.26.13
Using downloaded and verified file: /home/keki996e/.medmnist/pathmnist.npz
Using downloaded and verified file: /home/keki996e/.medmnist/pathmnist.npz
Using downloaded and verified file: /home/keki996e/.medmnist/pathmnist.npz
orig len89996
augmented n times0
  0%|          | 0/100 [00:00<?, ?it/s][54325-MainThread] [baal.modelwrapper:train_on_dataset:83] [2m2023-01-04T18:19:33.098537Z[0m [[32m[1minfo     [0m] [1mStarting training             [0m [36mdataset[0m=[35m3000[0m [36mepoch[0m=[35m20[0m
/lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  0%|          | 0/100 [00:09<?, ?it/s]
Traceback (most recent call last):
  File "/home/h3/keki996e/AL4ML/ACTIVE/OwnExperiments/Rep-Baal-Progress/Augmented/Experiments/all_vgg_pathmnist.py", line 281, in <module>
    main()
  File "/home/h3/keki996e/AL4ML/ACTIVE/OwnExperiments/Rep-Baal-Progress/Augmented/Experiments/all_vgg_pathmnist.py", line 207, in main
    model.train_on_dataset(
  File "/lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages/baal/modelwrapper.py", line 90, in train_on_dataset
    _ = self.train_on_batch(data, target, optimizer, use_cuda, regularizer)
  File "/lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages/baal/modelwrapper.py", line 315, in train_on_batch
    loss = self.criterion(output, target)
  File "/lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1174, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/lustre/ssd/ws/keki996e-all_pathmnist_cifar10/pyenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3026, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: 0D or 1D target tensor expected, multi-target not supported
